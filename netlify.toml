[build]
  base    = "frontend-react"
  publish = "dist"
  command = "npm run build"

[build.environment]
  NODE_VERSION = "20"

# Unified API on the same Netlify domain (frontend -> backend service).
[[redirects]]
  from   = "/api/ai/generate"
  to     = "/.netlify/functions/ai-generate"
  status = 200
  force  = true

[[redirects]]
  from   = "/api/search/specs"
  to     = "/.netlify/functions/search-specs"
  status = 200
  force  = true

[[redirects]]
  from   = "/api/search/eis"
  to     = "/.netlify/functions/search-eis"
  status = 200
  force  = true

[[redirects]]
  from   = "/api/*"
  to     = "https://tz-generator-backend.onrender.com/api/:splat"
  status = 200
  force  = true

# Proxy to zakupki.gov.ru for React EIS context fetcher (same-origin from browser).
[[redirects]]
  from   = "/proxy/zakupki/*"
  to     = "https://zakupki.gov.ru/:splat"
  status = 200
  force  = true

[[redirects]]
  from   = "/*"
  to     = "/index.html"
  status = 200
