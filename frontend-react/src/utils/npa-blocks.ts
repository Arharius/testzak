import { GOODS_CATALOG, getNacRegime, type NacRegime } from '../data/goods-catalog';

export type LawMode = '44' | '223';

// [label, text]
type Row2 = [string, string];

function fallbackRegime(goodsType: string): NacRegime {
  return getNacRegime(goodsType);
}

// ─── РАЗДЕЛ 2: Требования к качеству, безопасности ───────────────────────────
export function buildSection2Rows(
  goodsType: string,
  meta: Record<string, string>,
  lawMode: LawMode
): Row2[] {
  const g = GOODS_CATALOG[goodsType] ?? GOODS_CATALOG['pc'];
  const isSW = !!g.isSoftware;
  const is223 = lawMode === '223';
  const osNote = is223 ? '' : ' (ч. 3 ст. 33 44-ФЗ)';

  // ── Базовые строки ──
  const hwBase: Row2[] = [
    ['2.1. Состояние товара', 'Новый, заводской сборки, серийный, не бывший в эксплуатации, не восстановленный, не демонстрационный, в заводской упаковке производителя'],
    ['2.2. Соответствие стандартам', 'Товар должен соответствовать требованиям технических регламентов Таможенного союза (ТР ТС 004/2011, ТР ТС 020/2011), ГОСТ, а также иным обязательным требованиям, установленным законодательством РФ'],
    ['2.3. Комплектность', 'Поставляется в полной заводской комплектации, включая эксплуатационную документацию на русском языке, кабели, крепёж и иные штатные принадлежности'],
    ['2.4. Маркировка', 'Маркировка товара должна соответствовать требованиям законодательства РФ и обеспечивать однозначную идентификацию товара и производителя'],
  ];

  const swBase: Row2[] = [
    ['2.1. Форма поставки', 'Электронная лицензия (ключ активации) или материальный носитель — согласно условиям правообладателя'],
    ['2.2. Документация', 'Документация на русском языке: руководство пользователя, руководство администратора, описание применяемых криптографических средств (при наличии)'],
    ['2.3. Активация и установка', 'Поставщик обеспечивает передачу лицензионных ключей (ключей активации) и, при необходимости, оказывает содействие в установке ПО'],
  ];

  // ── НПА-блок ──
  const nacRegime = (meta.nac_regime as NacRegime) || fallbackRegime(goodsType);
  const law175basis = meta.law175_basis || '';
  const basisSuffix = law175basis ? '. ' + law175basis : '';

  let restrictionRows: Row2[] = [];

  if (is223) {
    if (nacRegime === 'pp1236') {
      restrictionRows = [
        ['⚖️ 2.4. Национальный режим (223-ФЗ, ПП РФ № 1875)',
          'В соответствии с Постановлением Правительства РФ от 23.12.2024 № 1875 при закупке программного обеспечения применяются меры национального режима. При формировании извещения Заказчик проверяет актуальную редакцию ПП РФ № 1875 на дату публикации закупки' + basisSuffix],
        ['2.5. Подтверждение российского/евразийского происхождения ПО',
          'Поставщик обязан представить реестровую запись (выписку) из реестра российского ПО Минцифры России или евразийского реестра ПО (если применимо по ПП РФ № 1875). Правила ведения реестров ПО определяются ПП РФ от 16.11.2015 № 1236 (в действующей редакции)'],
      ];
    } else if (nacRegime === 'pp878') {
      restrictionRows = [
        ['⚖️ 2.5. Национальный режим (223-ФЗ, ПП РФ № 1875)',
          'Для радиоэлектронной продукции применяются защитные меры в соответствии с Постановлением Правительства РФ от 23.12.2024 № 1875. Конкретная мера определяется по актуальной позиции товара в перечнях ПП РФ № 1875' + basisSuffix],
        ['2.6. Подтверждение происхождения радиоэлектронной продукции',
          'Поставщик обязан представить документы и (или) реестровые записи, предусмотренные ПП РФ № 1875 для подтверждения происхождения товара (российский/евразийский реестр промышленных товаров, при применимости — с учётом Решения Совета ЕЭК от 23.11.2020 № 105)'],
      ];
    } else if (nacRegime === 'pp616') {
      restrictionRows = [
        ['⚖️ 2.5. Национальный режим (223-ФЗ, ПП РФ № 1875)',
          'Для промышленных товаров национальный режим применяется в соответствии с Постановлением Правительства РФ от 23.12.2024 № 1875. Заказчик обязан использовать актуальные перечни и основания неприменения, действующие на дату публикации закупки' + basisSuffix],
        ['2.6. Подтверждение происхождения товара',
          'Поставщик обязан представить документы, предусмотренные ПП РФ № 1875 для соответствующей позиции товара (реестровая запись в ГИСП/евразийском реестре и иные подтверждающие документы при применимости)'],
      ];
    } else {
      restrictionRows = [
        ['2.5. Страна происхождения',
          'Указывается в товаросопроводительных документах. Ограничения по стране происхождения для данного вида товара в соответствии с Положением о закупке не установлены' + basisSuffix],
      ];
    }
  } else {
    // 44-ФЗ
    if (nacRegime === 'pp1236') {
      restrictionRows = [
        ['⚖️ 2.4. Национальный режим (ст. 14 44-ФЗ, ПП РФ № 1875)',
          'В соответствии с Федеральным законом от 05.04.2013 № 44-ФЗ (ст. 14) и Постановлением Правительства РФ от 23.12.2024 № 1875 при закупке программного обеспечения применяются защитные меры национального режима. Для ПО, включённого в соответствующие позиции перечней ПП РФ № 1875, применяется установленный этой нормой порядок допуска' + basisSuffix],
        ['2.5. Подтверждение включения в реестры ПО',
          'Поставщик обязан представить реестровую запись (выписку) из реестра российского ПО Минцифры России или евразийского реестра ПО (если применимо). Правила ведения реестра российского ПО определяются ПП РФ от 16.11.2015 № 1236 (в действующей редакции), реестр используется в том числе для целей применения ПП РФ № 1875'],
      ];
    } else if (nacRegime === 'pp878') {
      restrictionRows = [
        ['⚖️ 2.5. Национальный режим (ст. 14 44-ФЗ, ПП РФ № 1875)',
          'В соответствии с Федеральным законом от 05.04.2013 № 44-ФЗ (ст. 14) и Постановлением Правительства РФ от 23.12.2024 № 1875 для радиоэлектронной продукции применяются меры национального режима' + basisSuffix],
        ['2.6. Подтверждение происхождения радиоэлектронной продукции',
          'Поставщик обязан представить документы и (или) реестровые номера, предусмотренные ПП РФ № 1875 для подтверждения происхождения товара, включая реестры российской/евразийской промышленной продукции (при применимости — с учётом Решения Совета ЕЭК от 23.11.2020 № 105)'],
        ['2.7. Подтверждение производства в РФ (ПП РФ № 719)',
          'При применимости требований к промышленной продукции поставщик представляет сведения о включении товара в реестр российской промышленной продукции (ГИСП) в соответствии с ПП РФ от 17.07.2015 № 719 (в действующей редакции)'],
      ];
    } else if (nacRegime === 'pp616') {
      restrictionRows = [
        ['⚖️ 2.5. Национальный режим (ст. 14 44-ФЗ, ПП РФ № 1875)',
          'В соответствии с Федеральным законом от 05.04.2013 № 44-ФЗ (ст. 14) и Постановлением Правительства РФ от 23.12.2024 № 1875 для промышленных товаров применяются защитные меры национального режима в зависимости от позиции товара и условий закупки' + basisSuffix],
        ['2.6. Подтверждение происхождения товара',
          'Поставщик обязан представить документы и сведения, предусмотренные ПП РФ № 1875 для соответствующей позиции товара: реестровые записи российской/евразийской промышленной продукции (ГИСП, ПП РФ № 719) и иные подтверждающие документы при применимости'],
      ];
    } else {
      restrictionRows = [
        ['2.5. Страна происхождения',
          'Указывается в товаросопроводительных документах. Ограничения по стране происхождения в соответствии со ст. 14 Федерального закона от 05.04.2013 № 44-ФЗ для данного вида товара не установлены' + basisSuffix],
      ];
    }
  }

  // ── Специальные требования по типу товара ──
  const specialMap: Record<string, Row2[]> = {
    pc:         [['Совместимость с ОС', `Товар должен быть совместим с отечественными операционными системами, включёнными в Единый реестр российских программ для ЭВМ и БД Минцифры России, в том числе: Astra Linux Special Edition, ALT Linux, РЕД ОС или эквивалентными${osNote}`]],
    laptop:     [['Совместимость с ОС', `Товар должен быть совместим с отечественными операционными системами, включёнными в Единый реестр российских программ для ЭВМ и БД Минцифры России, в том числе: Astra Linux Special Edition, ALT Linux или эквивалентными${osNote}`]],
    server:     [['Совместимость с ОС', `Товар должен быть совместим с отечественными операционными системами серверной редакции, включёнными в Единый реестр российских программ для ЭВМ и БД Минцифры России, в том числе: Astra Linux Special Edition или эквивалентными; поддержка гипервизора KVM; поддержка IPMI/Redfish для удалённого управления${osNote}`]],
    monoblock:  [['Совместимость с ОС', `Товар должен быть совместим с отечественными операционными системами, включёнными в Единый реестр российских программ для ЭВМ и БД Минцифры России, в том числе: Astra Linux Special Edition, ALT Linux или эквивалентными${osNote}`]],
    firewall:   [
      ['Сертификат ФСТЭК России (МЭ)', 'Наличие действующего сертификата соответствия ФСТЭК России на межсетевой экран (МЭ) не ниже 4-го класса защиты в соответствии с Профилем защиты межсетевых экранов (утв. ФСТЭК России)'],
      ['Сертификат ФСТЭК России (СОВ)', 'При наличии функционала обнаружения вторжений — действующий сертификат соответствия ФСТЭК России на систему обнаружения вторжений (СОВ) не ниже 4-го класса защиты'],
    ],
    crypto:     [
      ['Лицензия ФСБ России (обязательно)', 'Поставщик обязан иметь действующую лицензию ФСБ России на осуществление деятельности по распространению шифровальных (криптографических) средств в соответствии с Постановлением Правительства РФ от 16.04.2012 № 313 (пп. «б» п. 4). Распространение СКЗИ без лицензии ФСБ запрещено'],
      ['Сертификат ФСБ России (СКЗИ)', 'Наличие действующего сертификата соответствия ФСБ России на СКЗИ не ниже класса КС1 в соответствии с Приказом ФСБ России от 09.02.2005 № 66 (требуемый класс определяется моделью угроз)'],
      ['Сертификат ФСТЭК', 'Наличие сертификата ФСТЭК России (при наличии требований по контролю отсутствия НДВ)'],
    ],
    antivirus:  [['Сертификат ФСТЭК России', 'Наличие действующего сертификата соответствия ФСТЭК России (для применения в государственных информационных системах и ИСПДн)']],
    dlp:        [['Сертификат ФСТЭК России', 'Наличие действующего сертификата соответствия ФСТЭК России']],
    siem:       [['Сертификат ФСТЭК России', 'Наличие действующего сертификата соответствия ФСТЭК России']],
    os:         [['Сертификат ФСТЭК России', 'Наличие действующего сертификата соответствия ФСТЭК России (для применения в ГИС, АСУ ТП, ИСПДн)']],
    email:      [['Совместимость с отечественным ПО', `Программное обеспечение должно функционировать на отечественных операционных системах (Astra Linux Special Edition, ALT Linux или эквивалентных), включённых в Единый реестр Минцифры России${osNote}`]],
    vks:        [
      ['Совместимость с отечественным ПО', `Программное обеспечение должно функционировать на отечественных ОС (Astra Linux, ALT Linux или эквивалентных) и поддерживать мобильные устройства под управлением российских ОС или мобильных платформ`],
      ['Шифрование', 'Защита передаваемых данных должна осуществляться с использованием сертифицированных средств криптографической защиты (СКЗИ) и/или TLS 1.2 и выше'],
    ],
    ecm:        [
      ['Совместимость с отечественным ПО', 'Программное обеспечение должно функционировать на отечественных ОС (Astra Linux, ALT Linux или эквивалентных) и СУБД (PostgreSQL или эквивалентной), включённых в Единый реестр Минцифры России'],
      ['Электронная подпись', 'Система должна поддерживать работу с квалифицированной электронной подписью (КЭП) в соответствии с Федеральным законом от 06.04.2011 № 63-ФЗ «Об электронной подписи» с использованием ГОСТ Р 34.10-2012/2018'],
    ],
    vdi:        [
      ['Сертификат ФСТЭК России', 'Наличие действующего сертификата соответствия ФСТЭК России (при применении в ГИС, ИСПДн)'],
      ['Совместимость с отечественным ПО', 'Платформа должна поддерживать развёртывание виртуальных рабочих мест на базе отечественных ОС (Astra Linux, ALT Linux или эквивалентных) и гипервизора KVM или эквивалентного, включённых в реестр Минцифры России'],
    ],
    edr:        [
      ['Сертификат ФСТЭК России', 'Наличие действующего сертификата соответствия ФСТЭК России (обязательно для применения в ГИС и ИСПДн)'],
      ['Совместимость с отечественными ОС', 'Агент EDR должен поддерживать работу на отечественных ОС (Astra Linux Special Edition, ALT Linux или эквивалентных), включённых в реестр Минцифры России'],
    ],
    waf:        [['Сертификат ФСТЭК России', 'Наличие действующего сертификата соответствия ФСТЭК России на средство защиты информации (при применении в ГИС)']],
    pam:        [
      ['Сертификат ФСТЭК России', 'Наличие действующего сертификата соответствия ФСТЭК России'],
      ['Совместимость с отечественным ПО', 'Система должна функционировать на отечественных ОС (Astra Linux, ALT Linux или эквивалентных) и поддерживать интеграцию с российскими СКЗИ'],
    ],
    iam:        [
      ['Сертификат ФСТЭК России', 'Наличие действующего сертификата соответствия ФСТЭК России (при применении в ГИС, ИСПДн)'],
      ['Совместимость с отечественным ПО', 'Система должна функционировать на отечественных ОС (Astra Linux, ALT Linux или эквивалентных) и СУБД (PostgreSQL или эквивалентной)'],
    ],
    pki:        [
      ['Лицензия ФСБ России (обязательно)', 'Поставщик обязан иметь действующую лицензию ФСБ России на осуществление деятельности по распространению шифровальных (криптографических) средств в соответствии с Постановлением Правительства РФ от 16.04.2012 № 313'],
      ['Сертификат ФСТЭК России', 'Наличие сертификата соответствия ФСТЭК России (при применении в ГИС)'],
      ['Поддержка ГОСТ', 'Программное обеспечение должно поддерживать отечественные криптографические алгоритмы: ГОСТ Р 34.10-2012, ГОСТ Р 34.11-2012, ГОСТ 28147-89 или их актуальные редакции'],
    ],
    vpn:        [
      ['Лицензия ФСБ России (обязательно)', 'Поставщик обязан иметь действующую лицензию ФСБ России на осуществление деятельности по распространению шифровальных (криптографических) средств в соответствии с Постановлением Правительства РФ от 16.04.2012 № 313 (пп. «б» п. 4). Реализация СКЗИ/VPN-средств без лицензии ФСБ запрещена'],
      ['Сертификат ФСБ России (СКЗИ)', 'Наличие действующего сертификата соответствия ФСБ России на СКЗИ (VPN-клиент/шлюз) не ниже класса КС1 в соответствии с Приказом ФСБ России от 09.02.2005 № 66'],
    ],
    backup_sw:  [['Совместимость с отечественным ПО', 'Программное обеспечение должно функционировать на отечественных ОС (Astra Linux, ALT Linux или эквивалентных) и поддерживать резервное копирование отечественных СУБД (PostgreSQL и др.)']],
    dbms:       [['Совместимость с отечественным ПО', `СУБД должна функционировать на отечественных ОС (Astra Linux, ALT Linux или эквивалентных), включённых в реестр Минцифры России${osNote}`]],
    erp:        [['Совместимость с отечественным ПО', 'Программное обеспечение должно функционировать на отечественных ОС (Astra Linux, ALT Linux или эквивалентных) и поддерживать отечественные СУБД (PostgreSQL и/или эквивалентные)']],
    virt:       [
      ['Сертификат ФСТЭК России', 'Наличие действующего сертификата соответствия ФСТЭК России на средство виртуализации (при применении в ГИС, ИСПДн)'],
      ['Совместимость с отечественным ПО', 'Платформа виртуализации должна поддерживать запуск гостевых ОС Astra Linux Special Edition, ALT Linux или эквивалентных'],
    ],
    firewall_sw:[
      ['Сертификат ФСТЭК России (МЭ)', 'Наличие действующего сертификата соответствия ФСТЭК России на межсетевой экран (МЭ) не ниже 4-го класса защиты'],
      ['Совместимость с отечественным ПО', 'ПО должно поддерживать установку на отечественные ОС (Astra Linux, ALT Linux или эквивалентные)'],
    ],
    itsm:       [['Совместимость с отечественным ПО', 'Программное обеспечение должно функционировать на отечественных ОС (Astra Linux, ALT Linux или эквивалентных) и СУБД (PostgreSQL или эквивалентной), включённых в реестр Минцифры России']],
    monitoring: [['Совместимость с отечественным ПО', 'Система мониторинга должна функционировать на отечественных ОС (Astra Linux, ALT Linux или эквивалентных) и поддерживать мониторинг отечественных программных продуктов']],
    mdm:        [['Совместимость', 'Система должна обеспечивать управление устройствами на отечественных мобильных платформах (Аврора ОС или эквивалентных при наличии) и стандартных ОС (iOS, Android)']],
    hr:         [
      ['Совместимость с отечественным ПО', 'Программное обеспечение должно функционировать на отечественных ОС (Astra Linux, ALT Linux или эквивалентных) и СУБД (PostgreSQL или эквивалентной)'],
      ['Соответствие законодательству', 'Программное обеспечение должно обеспечивать формирование отчётности в соответствии с действующим законодательством РФ (ТК РФ, НК РФ, требованиями СФР/ФНС)'],
    ],
    gis:        [
      ['Совместимость с отечественным ПО', 'Программное обеспечение должно функционировать на отечественных ОС (Astra Linux, ALT Linux или эквивалентных)'],
      ['Поддержка отечественных форматов', 'Система должна поддерживать форматы российских картографических данных и систем координат (МСК, СК-42, СК-95, WGS-84)'],
    ],
    project_sw: [['Совместимость с отечественным ПО', 'Программное обеспечение должно функционировать через веб-браузер на отечественных ОС (Astra Linux, ALT Linux или эквивалентных)']],
    bpm:        [['Совместимость с отечественным ПО', 'Программное обеспечение должно функционировать на отечественных ОС (Astra Linux, ALT Linux или эквивалентных) и СУБД (PostgreSQL или эквивалентной)']],
    portal:     [['Совместимость с отечественным ПО', 'Программное обеспечение должно функционировать на отечественных ОС (Astra Linux, ALT Linux или эквивалентных) и СУБД (PostgreSQL или эквивалентной), корректно отображаться в браузерах Яндекс.Браузер и/или Chromium на Astra Linux']],
    cad:        [['Совместимость с отечественным ПО', `Программное обеспечение должно функционировать на отечественных ОС (Astra Linux, ALT Linux или эквивалентных), включённых в реестр Минцифры России`]],
    ldap:       [
      ['Совместимость с отечественным ПО', `Программное обеспечение должно функционировать на отечественных ОС (Astra Linux Special Edition, ALT Linux или эквивалентных), включённых в Единый реестр Минцифры России${osNote}`],
      ['Реестр Минцифры России', 'Программное обеспечение должно быть включено в Единый реестр российских программ для ЭВМ и баз данных (реестр Минцифры) в соответствии с ПП РФ от 16.11.2015 № 1236'],
    ],
    reporting:  [
      ['Совместимость с отечественным ПО', 'Программное обеспечение должно функционировать на отечественных ОС (Astra Linux, ALT Linux или эквивалентных), включённых в реестр Минцифры России'],
      ['Актуальность форматов отчётности', 'Система должна обеспечивать формирование и передачу отчётности в форматах, соответствующих действующим требованиям ФНС России, СФР, Росстата на дату поставки'],
      ['Квалифицированная электронная подпись', 'Система должна поддерживать работу с квалифицированной электронной подписью (КЭП) в соответствии с Федеральным законом от 06.04.2011 № 63-ФЗ «Об электронной подписи»'],
    ],
  };

  const baseRows = isSW ? swBase : hwBase;
  const extraData = specialMap[goodsType] ?? [];
  const nextNum = baseRows.length + restrictionRows.length + 1;
  const extraRows: Row2[] = extraData.map(([label, val], idx) => [`2.${nextNum + idx}. ${label}`, val]);

  return [...baseRows, ...restrictionRows, ...extraRows];
}

// ─── РАЗДЕЛ 4: Гарантия и поставка ──────────────────────────────────────────
export function buildSection4Rows(goodsType: string, lawMode: LawMode): Row2[] {
  const g = GOODS_CATALOG[goodsType] ?? GOODS_CATALOG['pc'];
  const isSW = !!g.isSoftware;
  const is223 = lawMode === '223';
  const contractWord = is223 ? 'договора' : 'контракта';
  const contractArt  = is223 ? 'договором' : 'контрактом';

  if (isSW) {
    const docPackage = is223
      ? 'Факт поставки подтверждается подписанием акта приёма-передачи лицензий/ключей активации по форме, установленной Заказчиком. Поставщик предоставляет копию лицензионного договора или сублицензионного соглашения, выписку из реестра Минцифры России с актуальным регистрационным номером ПО'
      : 'Факт поставки подтверждается подписанием акта приёма-передачи лицензий/ключей активации. Поставщик предоставляет копию лицензионного договора или сублицензионного соглашения, выписку из реестра Минцифры России с актуальным регистрационным номером ПО';
    return [
      ['4.1. Срок поставки', `Не более 30 (тридцати) календарных дней с даты заключения ${contractWord}, если иное не предусмотрено условиями ${contractArt}`],
      ['4.2. Форма передачи', 'Передача лицензионных ключей (ключей активации) осуществляется в электронной форме на адрес электронной почты Заказчика или путём предоставления доступа в личном кабинете правообладателя'],
      ['4.3. Техническая поддержка', 'Поставщик обязан обеспечить техническую поддержку в течение не менее 12 (двенадцати) месяцев с даты передачи лицензии. Режим поддержки: 5×8 (рабочие дни, 09:00–18:00 МСК). Время реакции: P1 — не более 4 рабочих часов; P2 — не более 8 рабочих часов; P3 — не более 24 рабочих часов'],
      ['4.4. Обновления', `В течение срока технической поддержки Заказчик вправе получать обновления ПО (патчи, обновления безопасности, новые версии) без дополнительной оплаты`],
      ['4.5. Документы передачи', docPackage],
    ];
  }

  const WARRANTY_MONTHS: Record<string, number> = {
    pc: 36, laptop: 36, monoblock: 36, server: 36, serverRack: 36, serverBlade: 36,
    monitor: 36, printer: 12, mfu: 12, tablet: 12, thinClient: 36,
    switch: 36, router: 36, firewall: 12, accessPoint: 24,
    ups: 24, san: 36, nas: 36,
    cartridge: 12, paper: 12, toner: 12, drum: 12,
    ssd: 36, hdd: 36,
  };
  const DELIVERY_DAYS: Record<string, number> = {
    pc: 30, laptop: 30, monoblock: 30, tablet: 30, monitor: 30,
    printer: 14, mfu: 14, cartridge: 10, paper: 10, toner: 10, drum: 10,
    server: 60, serverRack: 90, serverBlade: 90, san: 90, nas: 60,
    switch: 30, router: 30, firewall: 30, accessPoint: 21,
    ups: 30, ssd: 14, hdd: 14,
  };
  const dTexts: Record<number, string> = {
    10:'десяти', 14:'четырнадцати', 21:'двадцати одного', 30:'тридцати', 60:'шестидесяти', 90:'девяноста'
  };

  const wMonths = WARRANTY_MONTHS[goodsType] ?? 12;
  const wText = wMonths === 36
    ? 'не менее 36 (тридцати шести) месяцев'
    : wMonths === 24
    ? 'не менее 24 (двадцати четырёх) месяцев'
    : 'не менее 12 (двенадцати) месяцев';

  const dDays = DELIVERY_DAYS[goodsType] ?? 60;
  const dText = `Не более ${dDays} (${dTexts[dDays] ?? dDays}) календарных дней с даты заключения ${contractWord}`;

  const docPackage = is223
    ? `первичный учётный документ по форме, предусмотренной договором (УПД или акт приёма-передачи), паспорт (формуляр) изделия, эксплуатационная документация на русском языке, гарантийный талон производителя (при наличии), выписка из реестра российской радиоэлектронной продукции (при применении ПП РФ № 878)`
    : `универсальный передаточный документ (УПД) или товарная накладная (ТОРГ-12), паспорт (формуляр) изделия, эксплуатационная документация на русском языке, гарантийный талон производителя (при наличии), выписка из реестра российской радиоэлектронной продукции (при применении ПП РФ № 878)`;

  return [
    ['4.1. Гарантийный срок', `Гарантийный срок на товар — ${wText} с даты подписания акта приёма-передачи товара. Гарантия производителя должна распространяться на весь поставляемый товар`],
    ['4.2. Место гарантийного обслуживания', 'Гарантийное обслуживание осуществляется на территории Российской Федерации в авторизованных сервисных центрах производителя или силами Поставщика'],
    ['4.3. Сроки устранения неисправностей', 'Поставщик обязан устранить неисправность (дефект) товара в течение 15 (пятнадцати) рабочих дней с момента получения письменного уведомления от Заказчика. При невозможности ремонта — произвести замену товара аналогичными характеристиками или выше'],
    ['4.4. Замена бракованного товара', 'В случае обнаружения производственного дефекта или несоответствия установленным требованиям Поставщик обязан произвести замену товара в течение 15 (пятнадцати) рабочих дней с момента соответствующего требования Заказчика'],
    ['4.5. Срок поставки', dText],
    ['4.6. Место поставки', 'Адрес поставки: по месту нахождения Заказчика. Транспортировка, разгрузка и доставка в указанное помещение — за счёт Поставщика'],
    ['4.7. Упаковка и маркировка', 'Товар поставляется в оригинальной заводской упаковке, обеспечивающей сохранность при транспортировке. Упаковка должна содержать маркировку производителя'],
    ['4.8. Сопроводительная документация', `Вместе с товаром передаются: ${docPackage}`],
  ];
}

// ─── РАЗДЕЛ 5: Иные требования ──────────────────────────────────────────────
export function buildSection5Rows(goodsType: string, lawMode: LawMode): Row2[] {
  const g = GOODS_CATALOG[goodsType] ?? GOODS_CATALOG['pc'];
  const isSW = !!g.isSoftware;
  const is223 = lawMode === '223';
  const contractWord = is223 ? 'договором' : 'контрактом';

  const hwRows: Row2[] = [
    ['5.1. Соответствие ТР ТС', 'Товар должен иметь декларацию о соответствии или сертификат соответствия требованиям технических регламентов Таможенного союза (ТР ТС 004/2011 «О безопасности низковольтного оборудования», ТР ТС 020/2011 «Электромагнитная совместимость технических средств»)'],
    ['5.2. Год выпуска', 'Товар должен быть выпущен не ранее чем за 12 (двенадцать) месяцев до даты поставки (год выпуска подтверждается серийным номером или сопроводительными документами)'],
    [`5.3. Приёмка товара`, `Заказчик вправе проверить соответствие поставленного товара требованиям настоящего технического задания. Приёмка осуществляется в соответствии с условиями ${contractWord}`],
    ['5.4. Ответственность поставщика', `В случае поставки товара, не соответствующего установленным требованиям, Поставщик обязан за свой счёт осуществить его замену в сроки, установленные ${contractWord}`],
  ];

  const swRows: Row2[] = [
    ['5.1. Лицензионная чистота', 'Поставляемое программное обеспечение должно быть лицензионно чистым. Поставщик гарантирует правомерность использования ПО и несёт ответственность за нарушение авторских и смежных прав'],
    ['5.2. Совместимость', 'Программное обеспечение должно корректно функционировать в среде Заказчика. Поставщик обязан проверить совместимость ПО с имеющейся инфраструктурой по запросу Заказчика'],
    ['5.3. Передача прав', 'Право использования ПО передаётся Заказчику на основании лицензионного договора (сублицензионного соглашения) в соответствии с требованиями части IV Гражданского кодекса РФ'],
  ];

  const rows: Row2[] = isSW ? swRows : hwRows;

  if (is223) {
    rows.push([`5.${rows.length + 1}. Соответствие Положению о закупке`,
      'Закупка осуществляется в соответствии с Федеральным законом от 18.07.2011 № 223-ФЗ «О закупках товаров, работ, услуг отдельными видами юридических лиц» и Положением о закупке Заказчика. Поставщик обязан соответствовать требованиям, установленным указанным Положением о закупке']);
  }

  return rows;
}
